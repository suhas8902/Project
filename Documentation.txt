# Documentation: Currency Conversion & Salary Management System

## Overview
This Node.js application automates the process of:
1. Reading employee data from an Excel file.
2. Converting salaries into a target currency using the ExchangeRate API.
3. Calculating local time based on the employeeâ€™s country.
4. Storing results in both Excel/JSON files and a MySQL database.

This makes it useful for global teams where payroll and reporting involve multiple currencies and time zones.

---

## Technologies Used
- Node.js â€“ Core runtime environment.
- xlsx â€“ Reading and writing Excel files.
- moment-timezone â€“ Handling country-specific local times.
- node-fetch â€“ Fetching exchange rates from the ExchangeRate API.
- mysql2 â€“ MySQL database connection and queries.
- fs â€“ File system operations (saving JSON/Excel).
- readline â€“ Capturing user input from the console.

---

## Project Workflow
1. Database Connection â€“ Connects to MySQL database.
2. Excel File Handling â€“ Reads employee details from `apiPractice.xlsx`.
3. User Input â€“ Asks user for a target currency (USD, INR, EUR, etc.).
4. Salary Conversion â€“ Uses ExchangeRate API to convert salaries.
5. Local Time Calculation â€“ Gets time from country â†’ timezone mapping.
6. Data Persistence â€“ Saves results to Excel, JSON, and MySQL.

---

## Key Components

### Country â†’ Timezone Mapping
Ensures local time is correctly computed per country. Defaults to UTC if not found.

### Excel Processing
Reads input Excel â†’ JSON â†’ converts â†’ saves back to Excel/JSON.

### Salary Conversion
- If currency = target â†’ keep same value.
- Else â†’ convert using API-provided exchange rates.

### Database Insertion
Inserts employee data into `incomesfreelance` table with salary + local time.

---

## Expected Output

### Console
```
âœ… Connected to MySQL Database
Enter target currency (e.g., INR, USD, EUR): usd

âœ… Results saved to:
ğŸ“„ apiPractice_converted.xlsx
ğŸ“„ apiPractice_converted.json
ğŸ’¾ Results inserted into MySQL database.
```

### Files Generated
- Excel: `apiPractice_converted.xlsx`
- JSON: `apiPractice_converted.json`

### Database Table (incomesfreelance)
| name | company | emp_id | age | salary | currency | country | target_currency | converted_salary | local_time |

---

## Error Handling
- âŒ Missing Excel file â†’ program exits.
- âŒ Empty sheet â†’ program exits.
- âš  Missing employee fields â†’ row skipped.
- âŒ No exchange rate found â†’ error thrown.
- âŒ MySQL insert errors logged.

---

## Future Improvements
- Dynamic timezone lookup instead of hardcoded mapping.
- Support multiple sheets in Excel.
- Batch API requests for performance.
- Add unit tests.
- GUI interface for non-technical users.

---

## Block Diagram

Program flow is represented below:

 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚       Start Program      â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  Connect to MySQL DB    â”‚
 â”‚  (currency_database_*)  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚   Load Excel File        â”‚
 â”‚   (apiPractice.xlsx)     â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚   Read Employee Data     â”‚
 â”‚   (JSON from Excel)      â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚   Ask User for Target    â”‚
 â”‚   Currency (e.g., USD)   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Fetch Exchange Rates     â”‚
 â”‚ from API (ExchangeRate)  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ For Each Employee:       â”‚
 â”‚ - Validate row           â”‚
 â”‚ - Convert Salary         â”‚
 â”‚ - Get Local Time (TZ)    â”‚
 â”‚ - Build Result Row       â”‚
 â”‚ - Insert into MySQL      â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Save Results to:         â”‚
 â”‚ - Excel File (.xlsx)     â”‚
 â”‚ - JSON File (.json)      â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Display Summary in CLI   â”‚
 â”‚ (files saved + DB status)â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚       End Program        â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

---
